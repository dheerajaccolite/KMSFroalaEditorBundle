!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("FroalaEditor")):"function"==typeof define&&define.amd?define(["FroalaEditor"],e):e(t.FroalaEditor)}(this,function(M){"use strict";M=M&&M.hasOwnProperty("default")?M["default"]:M,Object.assign(M.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style","text-indent","border","border-.*"],wordPasteModal:!0,wordPasteKeepFormatting:!0}),M.PLUGINS.wordPaste=function(A){var a,n,p=A.$,s="word_paste",h={};function e(t){var e=A.opts.wordAllowedStyleProps;t||(A.opts.wordAllowedStyleProps=[]),0===n.indexOf("<colgroup>")&&(n="<table>"+n+"</table>"),n=function u(t,e){0<=t.indexOf("<html")&&(t=t.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/i,"$1"));!function f(t){for(var e=t.split("v:shape"),r=1;r<e.length;r++){var i=e[r],n=i.split(' id="')[1];if(n&&1<n.length){n=n.split('"')[0];var l=i.split(' o:spid="')[1];l&&1<l.length&&(l=l.split('"')[0],h[n]=l)}}}(t);var r=(new DOMParser).parseFromString(t,"text/html"),i=r.head,n=r.body,l=function g(t){var e={},r=t.getElementsByTagName("style");if(r.length){var i=r[0],n=i.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(n)for(var l=0;l<n.length;l++){var a=n[l],s=a.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),o=a.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");s=s.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/\n|\r|\n\r/g,""),o=o.replace(/\n|\r|\n\r/g,"");for(var d=s.split(", "),f=0;f<d.length;f++)e[d[f]]=o}}return e}(i);m(n,function(t){if(t.nodeType===Node.TEXT_NODE&&/\n|\u00a0|\r/.test(t.data)){if(!/\S| /.test(t.data))return t.data===M.UNICODE_NBSP?(t.data="\u200b",!0):1===t.data.length&&10===t.data.charCodeAt(0)?(t.data=" ",!0):(y(t),!1);t.data=t.data.replace(/\n|\r/gi," ")}return!0}),m(n,function(t){return t.nodeType!==Node.ELEMENT_NODE||"V:IMAGEDATA"!==t.tagName&&"IMG"!==t.tagName||function d(t,e){if(!e)return;var r;if("IMG"===t.tagName){var i=t.getAttribute("src");if(!i||-1===i.indexOf("file://"))return;if(0===i.indexOf("file://")&&A.helpers.isURL(t.getAttribute("alt")))return void t.setAttribute("src",t.getAttribute("alt"));(r=h[t.getAttribute("v:shapes")])||(r=t.getAttribute("v:shapes"))}else r=t.parentNode.getAttribute("o:spid");if(t.removeAttribute("height"),!r)return;!function s(t){c={},C(t,"i","\\shppict"),C(t,"s","\\shp{")}(e);var n=c[r.substring(7)];if(n){var l=function o(t){for(var e=t.match(/[0-9a-f]{2}/gi),r=[],i=0;i<e.length;i++)r.push(String.fromCharCode(parseInt(e[i],16)));var n=r.join("");return btoa(n)}(n.image_hex),a="data:"+n.image_type+";base64,"+l;"IMG"===t.tagName?(t.src=a,t.setAttribute("data-fr-image-pasted",!0)):p(t.parentNode).before('<img data-fr-image-pasted="true" src="'+a+'" style="'+t.parentNode.getAttribute("style")+'">').remove()}}(t,e),!0});for(var a=n.querySelectorAll("ul > ul, ul > ol, ol > ul, ol > ol"),s=a.length-1;0<=s;s--)a[s].previousElementSibling&&"LI"===a[s].previousElementSibling.tagName&&a[s].previousElementSibling.appendChild(a[s]);m(n,function(t){if(t.nodeType===Node.TEXT_NODE)return t.data=t.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(t.nodeType!==Node.ELEMENT_NODE)return t.nodeType!==Node.COMMENT_NODE||(y(t),!1);if(N(t)){var e=t.parentNode,r=t.previousSibling,i=function c(t,e){var r=/[0-9a-zA-Z]./gi;var i=!1;var n=!1;var l=!1;var a;t.firstElementChild&&t.firstElementChild.firstElementChild&&t.firstElementChild.firstElementChild.firstChild&&!(i=i||r.test(t.firstElementChild.firstElementChild.firstChild.data||""))&&t.firstElementChild.firstElementChild.firstElementChild&&t.firstElementChild.firstElementChild.firstElementChild.firstChild&&(i=i||r.test(t.firstElementChild.firstElementChild.firstElementChild.firstChild.data||""));var s=i?"ol":"ul";var o=v(t);var d="<"+s+"><li>"+b(t,e);var f=t.nextElementSibling;null!==f&&(a=f.previousElementSibling);var g=t.parentNode;y(t);t=null;for(;f&&N(f);){var u=v(f);if(o<u)d+=c(f,e).outerHTML;else{if(u<o)break;f.firstElementChild&&f.firstElementChild.firstElementChild&&f.firstElementChild.firstElementChild.firstChild&&(r.lastIndex=0,n=r.test(f.firstElementChild.firstElementChild.firstChild.data||"")),a&&a.firstElementChild&&a.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstChild&&(r.lastIndex=0,l=r.test(a.firstElementChild.firstElementChild.firstChild.data||"")),l===undefined||l===n?d+="</li><li>"+b(f,e):d+=c(f,e).outerHTML}if(o=u,f.previousElementSibling||f.nextElementSibling||f.parentNode){var p=f;f=f.nextElementSibling,y(p),p=null}else f=a?a.nextElementSibling:g.firstElementChild}d+="</li></"+s+">";var h=document.createElement("div");h.innerHTML=d;var m=h.firstElementChild;return m}(t,l),n=null;return(n=r?r.nextSibling:e.firstChild)?e.insertBefore(i,n):e.appendChild(i),!1}return T(t,l)}),m(n,function(t){if(t.nodeType===Node.ELEMENT_NODE){var e=t.tagName;if(!t.innerHTML&&-1===["BR","IMG"].indexOf(e)){for(var r=t.parentNode;r&&(y(t),!(t=r).innerHTML);)r=t.parentNode;return!1}!function g(t){var e=t.getAttribute("style");if(!e)return;(e=S(e))&&";"!==e.slice(-1)&&(e+=";");var r=e.match(/(^|\S+?):.+?;{1,1}/gi);if(!r)return;for(var i={},n=0;n<r.length;n++){var l=r[n],a=l.split(":");2===a.length&&("text-align"===a[0]&&"SPAN"===t.tagName||(i[a[0]]=a[1]))}var s="";for(var o in i)if(i.hasOwnProperty(o)){if("font-size"===o&&"pt;"===i[o].slice(-3)){var d=null;try{d=parseFloat(i[o].slice(0,-3),10)}catch(f){d=null}d&&(d=Math.round(1.33*d),i[o]=d+"px;")}s+=o+":"+i[o]}s&&t.setAttribute("style",s)}(t)}return!0}),m(n,function(t){if(t&&"A"===t.nodeName&&""===t.href){for(var e=document.createDocumentFragment();t.firstChild;)e.appendChild(t.firstChild);t.parentNode.replaceChild(e,t)}return!0});var o=n.outerHTML,d=A.opts.htmlAllowedStyleProps;return A.opts.htmlAllowedStyleProps=A.opts.wordAllowedStyleProps,o=A.clean.html(o,A.opts.wordDeniedTags,A.opts.wordDeniedAttrs,!1),A.opts.htmlAllowedStyleProps=d,o}(n=n.replace(/<span[\n\r ]*style='mso-spacerun:yes'>([\r\n\u00a0 ]*)<\/span>/g,function(t,e){for(var r="",i=0;i++<e.length;)r+="&nbsp;";return r}),A.paste.getRtfClipboard());var r=A.doc.createElement("DIV");r.innerHTML=n,A.html.cleanBlankSpaces(r),n=r.innerHTML,n=(n=A.paste.cleanEmptyTagsAndDivs(n)).replace(/\u200b/g,""),function i(){A.modals.hide(s)}(),A.paste.clean(n,!0,!0),A.opts.wordAllowedStyleProps=e}function y(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t,e){if(e(t))for(var r=t.firstChild;r;){var i=r,n=r.previousSibling;r=r.nextSibling,m(i,e),i.previousSibling||i.nextSibling||i.parentNode||!r||n===r.previousSibling||!r.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!r||r.previousSibling||r.nextSibling||r.parentNode||(n?r=n.nextSibling?n.nextSibling.nextSibling:null:t.firstChild&&(r=t.firstChild.nextSibling)):r=n?n.nextSibling:t.firstChild}}function N(t){if(!t.getAttribute("style")||!/mso-list:[\s]*l/gi.test(t.getAttribute("style").replace(/\n/gi,"")))return!1;try{if(!t.querySelector('[style="mso-list:Ignore"]'))return!1}catch(e){return!1}return!0}function v(t){return t.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function b(t,e){var r=t.cloneNode(!0);if(-1!==["H1","H2","H3","H4","H5","H6"].indexOf(t.tagName)){var i=document.createElement(t.tagName.toLowerCase());i.setAttribute("style",t.getAttribute("style")),i.innerHTML=r.innerHTML,r.innerHTML=i.outerHTML}m(r,function(t){return t.nodeType===Node.ELEMENT_NODE&&("mso-list:Ignore"===t.getAttribute("style")&&t.parentNode.removeChild(t),T(t,e)),!0});var n=r.innerHTML;return n=n.replace(/<!--[\s\S]*?-->/gi,"")}function E(t,e){for(var r=document.createElement(e),i=0;i<t.attributes.length;i++){var n=t.attributes[i].name;r.setAttribute(n,t.getAttribute(n))}return r.innerHTML=t.innerHTML,t.parentNode.replaceChild(r,t),r}function x(t){var e=t.getAttribute("align");e&&(t.style["text-align"]=e,t.removeAttribute("align"))}function S(t){return t.replace(/\n|\r|\n\r|&quot;/g,"")}function w(t,e,r){if(e){var i=t.getAttribute("style");i&&";"!==i.slice(-1)&&(i+=";"),e&&";"!==e.slice(-1)&&(e+=";"),e=e.replace(/\n/gi,"");var n=null;n=r?(i||"")+e:e+(i||""),t.setAttribute("style",n)}}var c=null;function C(t,e,r){for(var i=t.split(r),n=1;n<i.length;n++){var l=i[n];if(1<(l=l.split("shplid")).length){l=l[1];for(var a="",s=0;s<l.length&&"\\"!==l[s]&&"{"!==l[s]&&" "!==l[s]&&"\r"!==l[s]&&"\n"!==l[s];)a+=l[s],s++;var o=l.split("bliptag");if(o&&o.length<2)continue;var d=null;if(-1!==o[0].indexOf("pngblip")?d="image/png":-1!==o[0].indexOf("jpegblip")&&(d="image/jpeg"),!d)continue;var f=o[1].split("}");if(f&&f.length<2)continue;var g=void 0;if(2<f.length&&-1!==f[0].indexOf("blipuid"))g=f[1].split(" ");else{if((g=f[0].split(" "))&&g.length<2)continue;g.shift()}var u=g.join("");c[e+a]={image_hex:u,image_type:d}}}}function T(t,e){var r=t.tagName,i=r.toLowerCase();t.firstElementChild&&("I"===t.firstElementChild.tagName?E(t.firstElementChild,"em"):"B"===t.firstElementChild.tagName&&E(t.firstElementChild,"strong"));if(-1!==["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(r))return y(t),!1;for(var n=["META","LINK","XML","ST1:","O:","W:","FONT"],l=0;l<n.length;l++)if(-1!==r.indexOf(n[l]))return t.innerHTML&&(t.outerHTML=t.innerHTML),y(t),!1;if("TD"!==r){var a=t.getAttribute("class");if(e&&a){for(var s=(a=S(a)).split(" "),o=0;o<s.length;o++){var d=[],f="."+s[o];d.push(f),f=i+f,d.push(f);for(var g=0;g<d.length;g++)e[d[g]]&&w(t,e[d[g]])}t.removeAttribute("class")}e&&e[i]&&w(t,e[i])}if(-1!==["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(r)){var u=t.getAttribute("class");if(u&&(e&&e[r.toLowerCase()+"."+u]&&w(t,e[r.toLowerCase()+"."+u]),-1!==u.toLowerCase().indexOf("mso"))){var p=S(u);(p=p.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""))?t.setAttribute("class",p):t.removeAttribute("class")}var h=t.getAttribute("style");if(h){var m=h.match(/text-align:.+?[; "]{1,1}/gi);m&&m[m.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}x(t)}if("TR"===r&&function C(t,e){A.node.clearAttributes(t);for(var r=t.firstElementChild,i=0,n=!1,l=null;r;){r.firstElementChild&&-1!==r.firstElementChild.tagName.indexOf("W:")&&(r.innerHTML=r.firstElementChild.innerHTML),(l=r.getAttribute("width"))||n||(n=!0),i+=parseInt(l,10),(!r.firstChild||r.firstChild&&r.firstChild.data===M.UNICODE_NBSP)&&(r.firstChild&&y(r.firstChild),r.innerHTML="<br>");for(var a=r.firstElementChild,s=1===r.children.length;a;)"P"!==a.tagName||N(a)||s&&x(a),a=a.nextElementSibling;if(e){var o=r.getAttribute("class");if(o){var d=(o=S(o)).match(/xl[0-9]+/gi);if(d){var f="."+d[0];e[f]&&w(r,e[f])}}e.td&&w(r,e.td)}var g=r.getAttribute("style");g&&(g=S(g))&&";"!==g.slice(-1)&&(g+=";");var u=r.getAttribute("valign");if(!u&&g){var p=g.match(/vertical-align:.+?[; "]{1,1}/gi);p&&(u=p[p.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var h=null;if(g){var m=g.match(/text-align:.+?[; "]{1,1}/gi);m&&(h=m[m.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"===h&&(h=null)}var c=null;if(g){var v=g.match(/background:.+?[; "]{1,1}/gi);v&&(c=v[v.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var b=r.getAttribute("colspan"),E=r.getAttribute("rowspan");b&&r.setAttribute("colspan",b),E&&r.setAttribute("rowspan",E),u&&(r.style["vertical-align"]=u),h&&(r.style["text-align"]=h),c&&(r.style["background-color"]=c),l&&r.setAttribute("width",l),r=r.nextElementSibling}for(r=t.firstElementChild;r;)l=r.getAttribute("width"),n?r.removeAttribute("width"):r.setAttribute("width",100*parseInt(l,10)/i+"%"),r=r.nextElementSibling}(t,e),"A"!==r||t.attributes.getNamedItem("href")||t.attributes.getNamedItem("name")||!t.innerHTML||(t.outerHTML=t.innerHTML),"TD"!==r&&"TH"!==r||t.innerHTML||(t.innerHTML="<br>"),"TABLE"===r&&(t.style.width="100%"),t.getAttribute("lang")&&t.removeAttribute("lang"),t.getAttribute("style")&&-1!==t.getAttribute("style").toLowerCase().indexOf("mso")){var c=S(t.getAttribute("style"));(c=c.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""))?t.setAttribute("style",c):t.removeAttribute("style")}return!0}return{_init:function t(){A.events.on("paste.wordPaste",function(t){return n=t,A.opts.wordPasteModal?function l(){if(!a){var t='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+A.language.translate("Word Paste Detected")+"</h4>",e=function n(){var t='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return t+='<p style="text-align: left;">'+A.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",t+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+A.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+A.language.translate("Keep")+"</button></div>",t+="</div>"}(),r=A.modals.create(s,t,e),i=r.$body;a=r.$modal,r.$modal.addClass("fr-middle"),A.events.bindClick(i,"button.fr-remove-word",function(){var t=a.data("instance")||A;t.wordPaste.clean()}),A.events.bindClick(i,"button.fr-keep-word",function(){var t=a.data("instance")||A;t.wordPaste.clean(!0)}),A.events.$on(p(A.o_win),"resize",function(){A.modals.resize(s)})}A.modals.show(s),A.modals.resize(s)}():e(A.opts.wordPasteKeepFormatting),!1})},clean:e}}});